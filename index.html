<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>RubikCube</title>
        <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" >
        <link rel="stylesheet" type="text/css" href="css/colorcube.css">
		<style>
			body {
                overflow-y: hidden; 
                margin: 0; 
            }
            .right-control-panel{
                right: 10px;
                position: absolute;
                width: 200px;
                height: 100px;
                border-radius: 5px;
                background-color: rgba(191,191,191,0.4);
                padding: 10px 10px;
            }
            .bottom-control-panel{
                position: absolute;
                bottom: 0px;
                width: 100%;
                height: 160px;
                border-radius: 5px;
                background-color: rgba(191,191,191,0.4);
                box-sizing: border-box;
            }
            .bottom-control-panel .command-panel{
                width: 63%;
                display: inline-block;
                padding: 10px 10px;
                height: 160px;
                border-right: 1px dotted rgba(41, 41, 219, 0.8);
                box-sizing: border-box;
            }
            .bottom-control-panel .action-panel{
                display: inline-block; 
                width: 36%;
                height: 160px;
                padding: 10px 10px;
                box-sizing: border-box;
                position: absolute;
                overflow: auto;
            }
            .action-control{
                margin: 3px 3px;
                border-radius: 12px;
                background-color: #759de6;
                cursor: pointer;
                font-size: 10px;
            }
            .action-control-group{
                border: 1px dotted rgba(41, 41, 219, 0.8);
                border-radius: 5px;
                display: inline-block;
                margin-bottom: 1px;
            }
            .command-output{
                width:98%;
                height: 100px;
            }
            .command-input{
                width: 90%;
            }
            .eye-button{
                width: 15px;
                height: 15px;
                cursor: pointer;
            }
            .eye-button span{
                width: 2px;
                height: 2px;
                position: absolute;
            }
            .eye-button span:nth-of-type(1){
                right: 20%;
                top: 20%;
                background-color: #009E60;
            }
            .eye-button span:nth-of-type(2){
                right: 50%;
                top: 20%;
                background-color: #FF5800;
            }
            .eye-button span:nth-of-type(3){
                right: 80%;
                top: 20%;
                background-color: #FFD500;
            }
            .eye-button span:nth-of-type(4){
                right: 20%;
                top: 50%;
                background-color: #C41E3A;
            }
            .eye-button span:nth-of-type(5){
                right: 50%;
                top: 50%;
                background-color: #FFFFFF;
            }
            .eye-button span:nth-of-type(6){
                right: 80%;
                top: 50%;
                background-color: #0051BA;
            }
            .eye-button span:nth-of-type(7){
                right: 20%;
                top: 80%;
                background-color: #FFD500;
            }
            .eye-button span:nth-of-type(8){
                right: 50%;
                top: 80%;
                background-color: #FF5800;
            }
            .eye-button span:nth-of-type(9){
                right: 80%;
                top: 80%;
                background-color: #009E60;
            }
		</style>
        <script type="importmap">
            {
                "imports": {
                    "three": "./js/threejs/three.module.js"
                }
            }
        </script>
        <script type="module">
            import * as frog from './ruuubik.js';

            const faceArr = ["B", "L", "U", "R", "D", "F"];
            window.onload = function(){
                frog.init(document.body);

                frog.addActionDoneCallback((notation) => {
                    let cubes = document.getElementsByClassName("cube");
                    for(let i = 0; i < cubes.length; i++){
                        let c = cubes[i];
                        let face = faceArr[Math.floor(i / 9)];
                        let color = frog.getFaceColor(face, i % 9 + 1);
                        c.style.backgroundColor = color;
                    }
                    if(notation && notation != ''){
                        notation = notation.replace('_', '\'')
                        let content = document.getElementsByClassName('command-output')[0].value;
                        document.getElementsByClassName('command-output')[0].value 
                            = content + " " + notation;
                    }

                });
            }
            window.onresize = function () {
                frog.resize();
            };

            var elements = document.getElementsByClassName("action-control");
            for(let i = 0; i < elements.length; i++){
                elements[i].onclick = (e) =>{
                    let action = e.target.getAttribute("action");
                    frog.doAction(action);
                }
            }

            document.onkeydown = (e) => {
                frog.doAction(e.key);
            }

            document.getElementById("rebaseBtn").onclick = () => {
                frog.rebase();
            }

            document.getElementById("resetBtn").onclick = () => {
                frog.reset();
            }

            document.getElementById("runBtn").onclick = () => {
                alert("开发中");
            }

            function panelDisplayToggle(panel){
                if(panel.style.display == "none"){
                    panel.style.display = "block";
                }else{
                    panel.style.display = "none";
                }
            }
            document.getElementById("bottomPanelClose").onclick = (e) => {
                panelDisplayToggle(document.getElementById("bottomControlPanel"));
            }

            document.getElementById("rightPanelClose").onclick = (e) => {
                panelDisplayToggle(document.getElementById("rightControlPanel"));
            }

            document.getElementById("cubeBoxPanelClose").onclick = (e) => {
                panelDisplayToggle(document.getElementById("cubeBoxPanel"));
            }
        </script>
	</head>
	<body>
        <div id="cubeBoxPanelClose" class="eye-button" style="position:absolute;left:0px;top:0px;">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div id="cubeBoxPanel" class="cube-box">
            <div class="cube cube-box-row-0 cube-box-col-3" style="background-color:#009E60;"><span class="cube-number">1</span></div>
            <div class="cube cube-box-row-0 cube-box-col-4" style="background-color:#009E60;"><span class="cube-number">2</span></div>
            <div class="cube cube-box-row-0 cube-box-col-5" style="background-color:#009E60;"><span class="cube-number">3</span></div>
            <div class="cube cube-box-row-1 cube-box-col-3" style="background-color:#009E60;"><span class="cube-number">4</span></div>
            <div class="cube cube-box-row-1 cube-box-col-4" style="background-color:#009E60;"><span class="cube-number">5</span></div>
            <div class="cube cube-box-row-1 cube-box-col-5" style="background-color:#009E60;"><span class="cube-number">6</span></div>
            <div class="cube cube-box-row-2 cube-box-col-3" style="background-color:#009E60;"><span class="cube-number">7</span></div>
            <div class="cube cube-box-row-2 cube-box-col-4" style="background-color:#009E60;"><span class="cube-number">8</span></div>
            <div class="cube cube-box-row-2 cube-box-col-5" style="background-color:#009E60;"><span class="cube-number">9</span></div>

            <div class="cube cube-box-row-3 cube-box-col-0" style="background-color:#FF5800;"><span class="cube-number">1</span></div>
            <div class="cube cube-box-row-3 cube-box-col-1" style="background-color:#FF5800;"><span class="cube-number">2</span></div>
            <div class="cube cube-box-row-3 cube-box-col-2" style="background-color:#FF5800;"><span class="cube-number">3</span></div>
            <div class="cube cube-box-row-4 cube-box-col-0" style="background-color:#FF5800;"><span class="cube-number">4</span></div>
            <div class="cube cube-box-row-4 cube-box-col-1" style="background-color:#FF5800;"><span class="cube-number">5</span></div>
            <div class="cube cube-box-row-4 cube-box-col-2" style="background-color:#FF5800;"><span class="cube-number">6</span></div>
            <div class="cube cube-box-row-5 cube-box-col-0" style="background-color:#FF5800;"><span class="cube-number">7</span></div>
            <div class="cube cube-box-row-5 cube-box-col-1" style="background-color:#FF5800;"><span class="cube-number">8</span></div>
            <div class="cube cube-box-row-5 cube-box-col-2" style="background-color:#FF5800;"><span class="cube-number">9</span></div>

            <div class="cube cube-box-row-3 cube-box-col-3" style="background-color:#FFD500;"><span class="cube-number">1</span></div>
            <div class="cube cube-box-row-3 cube-box-col-4" style="background-color:#FFD500;"><span class="cube-number">2</span></div>
            <div class="cube cube-box-row-3 cube-box-col-5" style="background-color:#FFD500;"><span class="cube-number">3</span></div>
            <div class="cube cube-box-row-4 cube-box-col-3" style="background-color:#FFD500;"><span class="cube-number">4</span></div>
            <div class="cube cube-box-row-4 cube-box-col-4" style="background-color:#FFD500;"><span class="cube-number">5</span></div>
            <div class="cube cube-box-row-4 cube-box-col-5" style="background-color:#FFD500;"><span class="cube-number">6</span></div>
            <div class="cube cube-box-row-5 cube-box-col-3" style="background-color:#FFD500;"><span class="cube-number">7</span></div>
            <div class="cube cube-box-row-5 cube-box-col-4" style="background-color:#FFD500;"><span class="cube-number">8</span></div>
            <div class="cube cube-box-row-5 cube-box-col-5" style="background-color:#FFD500;"><span class="cube-number">9</span></div>

            <div class="cube cube-box-row-3 cube-box-col-6" style="background-color:#C41E3A;"><span class="cube-number">1</span></div>
            <div class="cube cube-box-row-3 cube-box-col-7" style="background-color:#C41E3A;"><span class="cube-number">2</span></div>
            <div class="cube cube-box-row-3 cube-box-col-8" style="background-color:#C41E3A;"><span class="cube-number">3</span></div>
            <div class="cube cube-box-row-4 cube-box-col-6" style="background-color:#C41E3A;"><span class="cube-number">4</span></div>
            <div class="cube cube-box-row-4 cube-box-col-7" style="background-color:#C41E3A;"><span class="cube-number">5</span></div>
            <div class="cube cube-box-row-4 cube-box-col-8" style="background-color:#C41E3A;"><span class="cube-number">6</span></div>
            <div class="cube cube-box-row-5 cube-box-col-6" style="background-color:#C41E3A;"><span class="cube-number">7</span></div>
            <div class="cube cube-box-row-5 cube-box-col-7" style="background-color:#C41E3A;"><span class="cube-number">8</span></div>
            <div class="cube cube-box-row-5 cube-box-col-8" style="background-color:#C41E3A;"><span class="cube-number">9</span></div>

            <div class="cube cube-box-row-3 cube-box-col-9" style="background-color:#FFFFFF;"><span class="cube-number">1</span></div>
            <div class="cube cube-box-row-3 cube-box-col-10" style="background-color:#FFFFFF;"><span class="cube-number">2</span></div>
            <div class="cube cube-box-row-3 cube-box-col-11" style="background-color:#FFFFFF;"><span class="cube-number">3</span></div>
            <div class="cube cube-box-row-4 cube-box-col-9" style="background-color:#FFFFFF;"><span class="cube-number">4</span></div>
            <div class="cube cube-box-row-4 cube-box-col-10" style="background-color:#FFFFFF;"><span class="cube-number">5</span></div>
            <div class="cube cube-box-row-4 cube-box-col-11" style="background-color:#FFFFFF;"><span class="cube-number">6</span></div>
            <div class="cube cube-box-row-5 cube-box-col-9" style="background-color:#FFFFFF;"><span class="cube-number">7</span></div>
            <div class="cube cube-box-row-5 cube-box-col-10" style="background-color:#FFFFFF;"><span class="cube-number">8</span></div>
            <div class="cube cube-box-row-5 cube-box-col-11" style="background-color:#FFFFFF;"><span class="cube-number">9</span></div>

            <div class="cube cube-box-row-6 cube-box-col-3" style="background-color:#0051BA;"><span class="cube-number">1</span></div>
            <div class="cube cube-box-row-6 cube-box-col-4" style="background-color:#0051BA;"><span class="cube-number">2</span></div>
            <div class="cube cube-box-row-6 cube-box-col-5" style="background-color:#0051BA;"><span class="cube-number">3</span></div>
            <div class="cube cube-box-row-7 cube-box-col-3" style="background-color:#0051BA;"><span class="cube-number">4</span></div>
            <div class="cube cube-box-row-7 cube-box-col-4" style="background-color:#0051BA;"><span class="cube-number">5</span></div>
            <div class="cube cube-box-row-7 cube-box-col-5" style="background-color:#0051BA;"><span class="cube-number">6</span></div>
            <div class="cube cube-box-row-8 cube-box-col-3" style="background-color:#0051BA;"><span class="cube-number">7</span></div>
            <div class="cube cube-box-row-8 cube-box-col-4" style="background-color:#0051BA;"><span class="cube-number">8</span></div>
            <div class="cube cube-box-row-8 cube-box-col-5" style="background-color:#0051BA;"><span class="cube-number">9</span></div>
        </div>
        <div id="rightPanelClose" class="eye-button" style="position:absolute;right:0px;top:0px;">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
        <div id="rightControlPanel" class="right-control-panel">
            <button id="rebaseBtn" style="color: black">rebase</button>
            <button id="resetBtn" style="color: black">reset</button>
        </div>
        <div id="bottomControlPanel" class="bottom-control-panel">
            <div class="command-panel">
                <div>
                    <textarea readonly class="command-output"></textarea>
                </div>
                <div>
                    <input class="command-input" type="text"/>
                    <button id="runBtn" >run</button>
                </div>
            </div>
            <div class="action-panel">
                <div class="action-control-group">
                    <button action="R" class="action-control"  >R</button>
                    <button action="R_" class="action-control"  >R'</button>
                    <button action="R2" class="action-control"  >R2</button>
                </div>
                <div class="action-control-group">
                    <button action="U" class="action-control"  >U</button>
                    <button action="U_" class="action-control"  >U'</button>
                    <button action="U2" class="action-control"  >U2</button>
                </div>
                <div class="action-control-group">
                    <button action="F" class="action-control"  >F</button>
                    <button action="F_" class="action-control"  >F'</button>
                    <button action="F2" class="action-control"  >F2</button>
                </div>
                <div class="action-control-group">
                    <button action="D" class="action-control"  >D</button>
                    <button action="D_" class="action-control"  >D'</button>
                    <button action="D2" class="action-control"  >D2</button>
                </div>
                <div class="action-control-group">
                    <button action="L" class="action-control"  >L</button>
                    <button action="L_" class="action-control"  >L'</button>
                    <button action="L2" class="action-control"  >L2</button>
                </div>
                <div class="action-control-group">
                    <button action="B" class="action-control"  >B</button>
                    <button action="B_" class="action-control"  >B'</button>
                    <button action="B2" class="action-control"  >B2</button>
                </div>
                <div class="action-control-group">
                    <button action="E" class="action-control"  >E</button>
                    <button action="E_" class="action-control"  >E'</button>
                    <button action="E2" class="action-control"  >E2</button>
                </div>
                <div class="action-control-group">
                    <button action="M" class="action-control"  >M</button>
                    <button action="M_" class="action-control"  >M'</a>
                    <button action="M2" class="action-control"  >M2</button>
                </div>
                <div class="action-control-group">
                    <button action="S" class="action-control"  >S</button>
                    <button action="S_" class="action-control"  >S'</button>
                    <button action="S2" class="action-control"  >S2</button>
                </div>
                <div class="action-control-group">
                    <button action="r" class="action-control"  >r</button>
                    <button action="r_" class="action-control"  >r'</button>
                    <button action="r2" class="action-control"  >r2</button>
                </div>
                <div class="action-control-group">
                    <button action="u" class="action-control"  >u</button>
                    <button action="u_" class="action-control"  >u'</button>
                    <button action="u2" class="action-control"  >u2</button>
                </div>
                <div class="action-control-group">
                    <button action="f" class="action-control"  >f</button>
                    <button action="f_" class="action-control"  >f'</button>
                    <button action="f2" class="action-control"  >f2</button>
                </div>
                <div class="action-control-group">
                    <button action="l" class="action-control"  >l</button>
                    <button action="l_" class="action-control"  >l'</button>
                    <button action="l2" class="action-control"  >l2</button>
                </div>
                <div class="action-control-group">
                    <button action="d" class="action-control"  >d</button>
                    <button action="d_" class="action-control"  >d'</button>
                    <button action="d2" class="action-control"  >d2</button>
                </div>
                <div class="action-control-group">
                    <button action="x" class="action-control"  >x</button>
                    <button action="x_" class="action-control"  >x'</button>
                    <button action="x2" class="action-control"  >x2</button>
                </div>
                <div class="action-control-group">
                    <button action="y" class="action-control"  >y</button>
                    <button action="y_" class="action-control"  >y'</button>
                    <button action="y2" class="action-control"  >y2</button>
                </div>
                <div class="action-control-group">
                    <button action="z" class="action-control"  >z</button>
                    <button action="z_" class="action-control"  >z'</button>
                    <button action="z2" class="action-control"  >z2</button>
                </div>
            </div>
        </div>
        <div id="bottomPanelClose" class="eye-button" style="position:absolute;bottom:0px;right:0px;">
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
            <span></span>
        </div>
	</body>
</html>